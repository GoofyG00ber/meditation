<template>
  <div class="min-h-screen bg-linear-to-br from-cyan-50 via-blue-50 to-indigo-50">
    <div class="container mx-auto px-6 py-12">
      <div class="max-w-4xl mx-auto">
        <!-- Header -->
        <div class="text-center mb-12">
          <h1 class="text-4xl font-bold text-gray-800 mb-4">üßò Gyertyal√°ng medit√°ci√≥ (Trataka)</h1>
          <p class="text-lg text-gray-600">Koncentr√°ci√≥t er≈ës√≠t≈ë f√≥kuszgyakorlat</p>
          <p class="text-sm text-gray-500 mt-2">Id≈ëtartam: 4 perc</p>
        </div>

        <!-- Points Info / Login Reminder -->
        <PointsInfo
          exercise-type="study"
          :fixed-points="40"
          points-type="fixed"
        />

        <!-- Hero Image -->
        <div class="mb-12 rounded-2xl overflow-hidden shadow-lg">
          <img :src="heroImage" alt="Gyertyal√°ng medit√°ci√≥" class="w-full h-64 object-cover" loading="lazy" />
        </div>

        <!-- Introduction -->
        <div class="bg-white rounded-2xl p-8 shadow-lg mb-8">
          <h2 class="text-2xl font-bold text-gray-800 mb-4">Mi ez a gyakorlat?</h2>
          <p class="text-gray-700 leading-relaxed mb-4">
            A Trataka egy ≈ësi koncentr√°ci√≥s technika, amely sor√°n egy pontra (√°ltal√°ban gyertyal√°ngra) √∂sszpontos√≠tunk.
            Ez a gyakorlat er≈ës√≠ti a ment√°lis f√≥kuszt, csillap√≠tja a gondolati zajt, √©s jav√≠tja a tanul√°si teljes√≠tm√©nyt.
          </p>
          <div class="bg-blue-50 border-l-4 border-blue-500 p-4">
            <p class="text-gray-800 font-medium">
              üí° Tipp: A gyakorlat ut√°n mindig csukd be p√°r m√°sodpercre a szemed ‚Äì
              √≠gy elker√ºl√∂d a szemf√°rad√°st √©s teljesebben megmarad a nyugalom√©rzet.
            </p>
          </div>
        </div>

        <!-- Preparation -->
        <div class="bg-white rounded-2xl p-8 shadow-lg mb-8">
          <h2 class="text-2xl font-bold text-gray-800 mb-6">El≈ëk√©sz√ºletek</h2>
          <div class="space-y-4">
            <div class="flex items-start gap-3">
              <span class="text-2xl">üïØÔ∏è</span>
              <div>
                <h3 class="font-semibold text-gray-800">V√°lassz egy csendes helyet</h3>
                <p class="text-gray-700">Keress egy helyet, ahol nem zavarnak meg. A nyugodt √©s b√©k√©s k√∂rnyezet seg√≠ti a f√≥kuszt.</p>
              </div>
            </div>
            <div class="flex items-start gap-3">
              <span class="text-2xl">üéØ</span>
              <div>
                <h3 class="font-semibold text-gray-800">V√°lassz egy t√°rgyat</h3>
                <p class="text-gray-700">
                  A gyakori t√°rgyak k√∂z√© tartozik a gyertyal√°ng vagy egy kis pont a falon.
                  A gyertyal√°ng k√ºl√∂n√∂sen n√©pszer≈± dinamikus jellege miatt.
                </p>
              </div>
            </div>
            <div class="flex items-start gap-3">
              <span class="text-2xl">üßò</span>
              <div>
                <h3 class="font-semibold text-gray-800">Testtart√°s</h3>
                <p class="text-gray-700">
                  √úlj k√©nyelmesen keresztbe tett l√°bbal vagy egy sz√©ken egyenes h√°ttal.
                  Gy≈ëz≈ëdj meg r√≥la, hogy tested ellazult, de √©ber.
                </p>
              </div>
            </div>
          </div>
        </div>

        <!-- Practice Steps -->
        <div class="bg-white rounded-2xl p-8 shadow-lg mb-8">
          <h2 class="text-2xl font-bold text-gray-800 mb-6">A gyakorlat menete</h2>

          <div class="space-y-6">
            <div class="flex gap-4">
              <div class="shrink-0 w-12 h-12 bg-cyan-500 text-white rounded-full flex items-center justify-center font-bold text-lg">1</div>
              <div class="flex-1">
                <p class="text-gray-700 leading-relaxed">
                  Helyezkedj√ºnk el medit√°ci√≥s √ºl√©sben egy gyertya el≈ëtt, √©s csukjuk be a szem√ºnket.
                  A gyertya k√∂r√ºlbel√ºl karhossznyi t√°vols√°gra legyen. Ide√°lis esetben a kan√≥c mellmagass√°gban van,
                  ha t√∫l magasra helyezz√ºk, az fesz√ºlts√©get okozhat a szem√∂ld√∂kk√∂zpontban, vagy perzsel≈ë √©rz√©st kelthet a szemben.
                  A l√°ng mozdulatlanul √©gjen, ne lobogjon esetleges l√©ghuzat miatt sem.
                </p>
              </div>
            </div>

            <div class="flex gap-4">
              <div class="shrink-0 w-12 h-12 bg-cyan-500 text-white rounded-full flex items-center justify-center font-bold text-lg">2</div>
              <div class="flex-1">
                <p class="text-gray-700 leading-relaxed">
                  Nyissuk ki a szem√ºnket, √©s n√©zz√ºnk pislog√°s n√©lk√ºl a l√°ngba. A l√°ngnak h√°rom sz√≠ntartom√°nya van:
                  alul a kan√≥cn√°l v√∂r√∂ses, k√∂z√©pen vil√°gos feh√©r, a cs√∫cs√°n√°l enyh√©n f√ºstsz√≠n≈±.
                  <span class="font-semibold">√ñsszpontos√≠tsunk a l√°ng legvil√°gosabb, feh√©r f√©ny≈± szakasz√°nak fels≈ë tartom√°ny√°ra.</span>
                </p>
              </div>
            </div>

            <div class="flex gap-4">
              <div class="shrink-0 w-12 h-12 bg-cyan-500 text-white rounded-full flex items-center justify-center font-bold text-lg">3</div>
              <div class="flex-1">
                <p class="text-gray-700 leading-relaxed">
                  Ism√©t hunyjuk le a szem√ºnket. Ha megjelenik el≈ëtt√ºnk a l√°ng, √∂sszpontos√≠tsunk r√°,
                  de ne pr√≥b√°ljuk k√∂vetni vagy r√∂gz√≠teni a k√©pet, mert akkor elt≈±nik.
                </p>
              </div>
            </div>

            <div class="flex gap-4">
              <div class="shrink-0 w-12 h-12 bg-cyan-500 text-white rounded-full flex items-center justify-center font-bold text-lg">4</div>
              <div class="flex-1">
                <p class="text-gray-700 leading-relaxed">
                  Ism√©telj√ºk meg 3-szor a teljes gyakorlatot.
                </p>
              </div>
            </div>

            <div class="bg-amber-50 border-l-4 border-amber-500 p-4">
              <p class="text-gray-800 font-medium">
                ‚ö†Ô∏è Fontos: Lassan, fokozatosan √©p√≠ts√ºk fel a gyakorlatot: kezdetben csak 10-15 m√°sodpercig n√©zz√ºnk a l√°ngba.
                Az id≈ëtartamot apr√°nk√©nt n√∂velhetj√ºk, √©s 1 √©v m√∫lva ak√°r 1 percig is n√©zhet√ºnk a l√°ngba,
                s ut√°na 4 percen √°t √∂sszpontos√≠thatunk csukott szemmel a bels≈ë k√©p√©re.
                Ezt az id≈ëtartamot azonban semmik√©ppen se l√©pj√ºk t√∫l.
              </p>
            </div>

            <div class="bg-gray-50 p-4 rounded-lg">
              <p class="text-gray-700 text-sm">
                <span class="font-semibold">Alternat√≠v m√≥dszer:</span> A tratakot fekete pap√≠ron lev≈ë feh√©r ponttal,
                vagy feh√©r pap√≠ron lev≈ë fekete ponttal is gyakorolhatjuk. Amennyiben feh√©r pontra √∂sszpontos√≠tunk,
                annak k√©p√©t csukott szemmel feket√©nek l√°tjuk, √©s ford√≠tva.
              </p>
            </div>
          </div>
        </div>

        <!-- Benefits -->
        <div class="bg-linear-to-r from-cyan-500 to-blue-500 rounded-2xl p-8 shadow-lg text-white mb-8">
          <h2 class="text-2xl font-bold mb-4">El≈ënyei</h2>
          <div class="grid md:grid-cols-2 gap-4">
            <div class="flex items-start gap-3">
              <span class="text-2xl">‚úì</span>
              <p>F√≥kusz √©s figyelem: edzi az elm√©t egy pontra ir√°nyul√≥ koncentr√°ci√≥ra, jav√≠tja a tanul√°si teljes√≠tm√©nyt</p>
            </div>
            <div class="flex items-start gap-3">
              <span class="text-2xl">‚úì</span>
              <p>Ment√°lis tisztas√°g: cs√∂kkenti a gondolati zajt, el≈ëseg√≠ti a nyugodt, tiszta gondolkod√°st</p>
            </div>
            <div class="flex items-start gap-3">
              <span class="text-2xl">‚úì</span>
              <p>Stresszcs√∂kkent√©s: a lass√∫, f√≥kusz√°lt tekint√©s √©s l√©gz√©s aktiv√°lja a paraszimpatikus idegrendszert</p>
            </div>
            <div class="flex items-start gap-3">
              <span class="text-2xl">‚úì</span>
              <p>Szemeg√©szs√©g: er≈ës√≠ti a szemizmokat, cs√∂kkenti a k√©perny≈ë okozta f√°radts√°got</p>
            </div>
            <div class="flex items-start gap-3">
              <span class="text-2xl">‚úì</span>
              <p>Spiritu√°lis kapcsolat: seg√≠ti az √∂nreflexi√≥t √©s a bels≈ë b√©ke meg√©l√©s√©t</p>
            </div>
          </div>
        </div>

        <!-- Back Button -->
        <div class="mt-8 flex justify-center gap-4">
          <router-link
            to="/sessions"
            class="inline-block bg-cyan-500 hover:bg-cyan-600 text-white font-semibold px-8 py-3 rounded-lg transition-colors"
          >
            ‚Üê Vissza a gyakorlatokhoz
          </router-link>

          <button
            v-if="authStore.isAuthenticated && !completed"
            @click="() => completeExercise()"
            :disabled="completing"
            class="bg-green-500 hover:bg-green-600 disabled:bg-gray-400 text-white font-semibold px-8 py-3 rounded-lg transition-colors"
          >
            {{ completing ? 'Ment√©s...' : 'Gyakorlat befejezve ‚úì' }}
          </button>
        </div>

        <!-- Completion Message -->
        <div v-if="completed" class="mt-6 bg-green-50 border-l-4 border-green-500 rounded-lg p-6 text-center">
          <p class="text-lg font-semibold text-green-800">üéâ Gratul√°lunk! Befejezted a gyakorlatot!</p>
          <p class="text-green-700 mt-2">+{{ earnedPoints }} pont</p>
        </div>
      </div>
    </div>

    <!-- Badge Modal -->
    <BadgeModal
      v-if="newBadge"
      :show="showBadgeModal"
      :badge="newBadge"
      @close="closeBadgeModal"
    />
  </div>
</template>

<script setup lang="ts">
import { nextPlaceholder } from '../../utils/placeholders'
import { useAuthStore } from '../../stores/auth'
import { useMeditationPoints } from '../../composables/useMeditationPoints'
import PointsInfo from '../../components/PointsInfo.vue'
import BadgeModal from '../../components/BadgeModal.vue'

const heroImage = nextPlaceholder()
const authStore = useAuthStore()

const {
  completed,
  completing,
  earnedPoints,
  showBadgeModal,
  newBadge,
  completeExercise,
  closeBadgeModal
} = useMeditationPoints('study')
</script>
